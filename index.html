<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Happy Birthday ‚ù§Ô∏è</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FF6B8B;
            --secondary: #6C63FF;
            --accent: #FFD166;
            --dark: #333333;
            --light: #F8F9FA;
            --success: #06D6A0;
            --love: #FF1493;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html {
            scroll-behavior: smooth;
            height: 100%;
            touch-action: manipulation;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #fdfcfb 0%, #f5f7fa 100%);
            color: var(--dark);
            min-height: 100vh;
            overflow-x: hidden;
            padding: 0;
            position: relative;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Loading Screen */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #fdfcfb 0%, #f5f7fa 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999999;
            transition: opacity 0.5s ease;
        }
        
        .loading.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .loader {
            width: 60px;
            height: 60px;
            position: relative;
        }
        
        .loader-heart {
            position: absolute;
            width: 100%;
            height: 100%;
            color: var(--love);
            font-size: 3rem;
            animation: heartbeat 1.5s infinite ease-in-out;
        }
        
        .loader-text {
            margin-top: 20px;
            color: var(--primary);
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        /* Mobile-first responsive design */
        .container {
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
            padding: 0 15px;
            position: relative;
            z-index: 1;
            opacity: 0;
            animation: fadeInUp 0.8s ease 0.5s forwards;
        }
        
        /* Header for mobile */
        header {
            text-align: center;
            padding: 40px 15px 30px;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, rgba(255,107,139,0.1) 0%, rgba(108,99,255,0.1) 100%);
            margin-bottom: 25px;
            backdrop-filter: blur(5px);
        }
        
        .header-content {
            position: relative;
            z-index: 2;
        }
        
        h1 {
            font-family: 'Dancing Script', cursive;
            color: var(--primary);
            font-size: 2.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            animation: titleFloat 3s ease-in-out infinite alternate;
            line-height: 1.2;
            word-wrap: break-word;
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: #555;
            margin-bottom: 15px;
            font-weight: 300;
            line-height: 1.5;
        }
        
        .birthday-person {
            font-size: 2.2rem;
            color: var(--secondary);
            font-weight: 700;
            margin: 25px 0;
            text-transform: capitalize;
            animation: glow 2s ease-in-out infinite alternate;
            position: relative;
            display: inline-block;
            padding: 0 15px;
            word-wrap: break-word;
            max-width: 100%;
        }
        
        .birthday-person::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 3px;
            background: linear-gradient(to right, transparent, var(--accent), transparent);
            bottom: -10px;
            left: 0;
            border-radius: 2px;
        }
        
        /* Touch-friendly buttons */
        .love-btn, .celebration-btn, .close-heart-btn {
            min-height: 50px;
            min-width: 200px;
            font-size: 1.2rem;
            padding: 16px 30px;
            border-radius: 15px;
            border: none;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin: 10px 0;
            touch-action: manipulation;
            user-select: none;
        }
        
        /* Prevent zoom on input for iOS */
        @media screen and (max-width: 768px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }
        
        /* Remove blue highlight on tap for mobile */
        *:focus {
            outline: none;
        }
        
        /* Touch-friendly cards */
        .card {
            background: white;
            border-radius: 20px;
            padding: 25px 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            margin: 20px 0;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            width: 100%;
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp 0.6s ease 0.8s forwards;
        }
        
        .card h2 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            padding-bottom: 12px;
            justify-content: center;
            text-align: center;
        }
        
        .card h2::after {
            content: '';
            position: absolute;
            width: 60px;
            height: 3px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
        }
        
        .wishes {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #555;
            margin-bottom: 20px;
        }
        
        .wishes p {
            margin-bottom: 20px;
            position: relative;
            padding-left: 20px;
            padding-right: 10px;
        }
        
        /* Love Button Section for mobile */
        .love-button-section {
            text-align: center;
            margin: 40px auto;
            padding: 30px 20px;
            background: linear-gradient(135deg, rgba(255,20,147,0.05) 0%, rgba(255,107,139,0.05) 100%);
            border-radius: 25px;
            position: relative;
            overflow: hidden;
            border: 2px dashed rgba(255, 20, 147, 0.3);
            backdrop-filter: blur(10px);
            width: 100%;
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp 0.6s ease 1s forwards;
        }
        
        .love-button-section h2 {
            color: var(--love);
            margin-bottom: 20px;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            z-index: 1;
        }
        
        .love-button-section p {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }
        
        .love-btn {
            background: linear-gradient(135deg, var(--love) 0%, #FF6B8B 100%);
            color: white;
            box-shadow: 0 10px 25px rgba(255, 20, 147, 0.2);
            position: relative;
            overflow: hidden;
            z-index: 1;
            transform: scale(0.9);
            opacity: 0;
            animation: bounceIn 0.6s ease 1.2s forwards;
        }
        
        .love-btn:active {
            transform: scale(0.95);
        }
        
        /* Heart Formation Container for mobile */
        .heart-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s ease;
            padding: 20px;
        }
        
        .heart-container.active {
            display: flex;
            opacity: 1;
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Heart Formation optimized for mobile */
        .heart-formation {
            position: relative;
            width: 280px;
            height: 280px;
            z-index: 4;
            pointer-events: none;
        }
        
        .heart-float {
            position: absolute;
            color: var(--love);
            font-size: 1.2rem;
            opacity: 0;
            filter: drop-shadow(0 0 10px rgba(255, 20, 147, 0.8));
            z-index: 3;
            transform: translate(var(--target-x), var(--target-y)) scale(0.1);
            transition: transform 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 1s ease;
            touch-action: none;
        }
        
        .heart-float.forming {
            transform: translate(var(--target-x), var(--target-y)) scale(1);
            opacity: 1;
        }
        
        .heart-float.pulsing {
            animation: heartPulse 1s ease-in-out infinite alternate;
        }
        
        /* Extra floating hearts */
        .extra-heart, .decorative-heart {
            position: absolute;
            color: var(--love);
            filter: drop-shadow(0 0 8px rgba(255, 20, 147, 0.6));
            pointer-events: none;
            z-index: 2;
            opacity: 0;
        }
        
        /* Heart Message for mobile */
        .heart-message {
            text-align: center;
            margin-top: 30px;
            color: white;
            width: 100%;
            max-width: 100%;
            z-index: 3;
            padding: 0 15px;
        }
        
        .heart-message h2 {
            font-family: 'Dancing Script', cursive;
            font-size: 2.2rem;
            color: var(--love);
            margin-bottom: 15px;
            text-shadow: 0 0 15px rgba(255, 20, 147, 0.5);
            animation: pulse 2s infinite;
            line-height: 1.3;
        }
        
        .heart-message p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
            color: #f0f0f0;
        }
        
        .close-heart-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .close-heart-btn:active {
            transform: scale(0.98);
        }
        
        /* Celebration Section for mobile */
        .celebration-section {
            text-align: center;
            margin: 40px auto;
            padding: 30px 20px;
            background: linear-gradient(135deg, rgba(255,107,139,0.05) 0%, rgba(108,99,255,0.05) 100%);
            border-radius: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            width: 100%;
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp 0.6s ease 1.4s forwards;
        }
        
        .celebration-section h2 {
            color: var(--secondary);
            margin-bottom: 20px;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .celebration-section p {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .celebration-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            box-shadow: 0 10px 25px rgba(108, 99, 255, 0.2);
            position: relative;
            overflow: hidden;
            z-index: 1;
            transform: scale(0.9);
            opacity: 0;
            animation: bounceIn 0.6s ease 1.6s forwards;
        }
        
        .celebration-btn:active {
            transform: scale(0.95);
        }
        
        /* Confetti styles */
        .confetti-piece {
            position: fixed;
            pointer-events: none;
            opacity: 0;
            z-index: 9999;
            border-radius: 50%;
        }
        
        /* Signature for mobile */
        .signature {
            text-align: center;
            margin: 40px auto 30px;
            padding: 25px 20px;
            background: linear-gradient(135deg, rgba(255,107,139,0.05) 0%, rgba(108,99,255,0.05) 100%);
            border-radius: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            width: 100%;
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp 0.6s ease 1.8s forwards;
        }
        
        .signature p {
            font-family: 'Dancing Script', cursive;
            color: var(--primary);
            font-size: 2rem;
            margin-bottom: 10px;
            animation: heartbeat 2s infinite;
        }
        
        .signature .from {
            font-size: 1.1rem;
            color: #666;
            font-style: italic;
        }
        
        /* Footer for mobile */
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 30px 20px;
            color: #777;
            font-size: 0.9rem;
            background: linear-gradient(135deg, rgba(255,107,139,0.05) 0%, rgba(108,99,255,0.05) 100%);
            border-radius: 25px 25px 0 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            width: 100%;
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp 0.6s ease 2s forwards;
        }
        
        .heart-icon {
            color: var(--love);
            animation: heartbeat 1.5s infinite;
            display: inline-block;
            margin: 0 3px;
        }
        
        /* Background Hearts for mobile (reduced count for performance) */
        .background-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        
        .bg-heart {
            position: absolute;
            color: rgba(255, 20, 147, 0.15);
            font-size: 1.2rem;
            opacity: 0;
            filter: drop-shadow(0 0 3px rgba(255, 20, 147, 0.2));
            z-index: -1;
            animation: floatBackground 20s linear infinite;
        }
        
        /* Animations optimized for mobile */
        @keyframes titleFloat {
            0% { transform: translateY(0); }
            100% { transform: translateY(-10px); }
        }
        
        @keyframes glow {
            0% { text-shadow: 0 0 10px rgba(255,107,139,0.5); }
            100% { text-shadow: 0 0 20px rgba(255,107,139,0.8), 0 0 30px rgba(108,99,255,0.5); }
        }
        
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        @keyframes fadeInUp {
            0% { 
                transform: translateY(20px);
                opacity: 0;
            }
            100% { 
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes bounceIn {
            0% { 
                transform: scale(0.9);
                opacity: 0;
            }
            60% { 
                transform: scale(1.05);
                opacity: 1;
            }
            100% { 
                transform: scale(1);
                opacity: 1;
            }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        @keyframes heartPulse {
            0% { transform: scale(1) translate(var(--target-x), var(--target-y)); }
            50% { transform: scale(1.1) translate(var(--target-x), var(--target-y)); }
            100% { transform: scale(1) translate(var(--target-x), var(--target-y)); }
        }
        
        @keyframes floatBackground {
            0% {
                transform: translateY(100vh) rotate(0deg) scale(0.5);
                opacity: 0;
            }
            10% {
                opacity: 0.5;
            }
            90% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-100px) rotate(360deg) scale(1);
                opacity: 0;
            }
        }
        
        @keyframes floatAround {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 0.7; }
            25% { transform: translate(15px, 15px) rotate(90deg); opacity: 0.8; }
            50% { transform: translate(0, 30px) rotate(180deg); opacity: 0.7; }
            75% { transform: translate(-15px, 15px) rotate(270deg); opacity: 0.8; }
            100% { transform: translate(0, 0) rotate(360deg); opacity: 0.7; }
        }
        
        @keyframes heartFormation {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: scale(1) rotate(360deg);
                opacity: 1;
            }
        }
        
        /* iPad and larger phones */
        @media (min-width: 480px) and (max-width: 768px) {
            .container {
                padding: 0 20px;
            }
            
            h1 {
                font-size: 3.5rem;
            }
            
            .birthday-person {
                font-size: 2.5rem;
            }
            
            .card {
                padding: 30px 25px;
            }
            
            .card h2 {
                font-size: 1.8rem;
            }
            
            .heart-formation {
                width: 320px;
                height: 320px;
            }
            
            .heart-message h2 {
                font-size: 2.5rem;
            }
        }
        
        /* Desktop - for larger screens */
        @media (min-width: 769px) {
            .container {
                max-width: 800px;
                padding: 0 30px;
            }
            
            header {
                padding: 60px 30px 40px;
                border-radius: 0 0 40px 40px;
                margin-bottom: 40px;
            }
            
            h1 {
                font-size: 4.5rem;
            }
            
            .subtitle {
                font-size: 1.4rem;
            }
            
            .birthday-person {
                font-size: 3.2rem;
            }
            
            .card {
                padding: 40px 35px;
                border-radius: 25px;
                margin: 30px 0;
            }
            
            .card h2 {
                font-size: 2rem;
            }
            
            .wishes {
                font-size: 1.2rem;
            }
            
            .love-button-section, .celebration-section, .signature {
                padding: 50px 40px;
                border-radius: 30px;
                margin: 60px auto;
            }
            
            .love-button-section h2, .celebration-section h2 {
                font-size: 2.2rem;
            }
            
            .love-btn, .celebration-btn {
                padding: 20px 40px;
                font-size: 1.3rem;
            }
            
            .heart-formation {
                width: 400px;
                height: 400px;
            }
            
            .heart-message h2 {
                font-size: 3.2rem;
            }
        }
        
        /* Extra small devices */
        @media (max-width: 360px) {
            h1 {
                font-size: 2.4rem;
            }
            
            .birthday-person {
                font-size: 1.9rem;
            }
            
            .love-btn, .celebration-btn, .close-heart-btn {
                min-width: 180px;
                padding: 14px 25px;
                font-size: 1.1rem;
            }
            
            .heart-formation {
                width: 250px;
                height: 250px;
            }
            
            .heart-message h2 {
                font-size: 2rem;
            }
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                color: #f0f0f0;
            }
            
            .card {
                background: #1e293b;
                color: #f0f0f0;
            }
            
            .wishes {
                color: #ddd;
            }
            
            .subtitle {
                color: #ccc;
            }
            
            .love-button-section, .celebration-section, .signature, footer {
                background: linear-gradient(135deg, rgba(255,107,139,0.1) 0%, rgba(108,99,255,0.1) 100%);
            }
            
            .bg-heart {
                color: rgba(255, 20, 147, 0.1);
            }
        }
        
        /* Performance optimizations */
        .will-change {
            will-change: transform, opacity;
        }
        
        /* Prevent text selection on buttons */
        .no-select {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading" id="loading">
        <div style="text-align: center;">
            <div class="loader">
                <div class="loader-heart">‚ù§Ô∏è</div>
            </div>
            <div class="loader-text">Loading Birthday Magic...</div>
        </div>
    </div>
    
    <!-- Background Hearts -->
    <div class="background-hearts" id="background-hearts"></div>
    
    <!-- Heart Formation Container -->
    <div class="heart-container" id="heart-container">
        <div class="heart-formation" id="heart-formation">
            <!-- Floating hearts will be generated here to form a heart shape -->
        </div>
        <div class="heart-message">
            <h2 id="heart-title">For You, My Love</h2>
            <p id="heart-message-text">Each floating heart represents a piece of my love for you. Together they form a complete heart, just like our love completes each other. Happy Birthday!</p>
            <button class="close-heart-btn no-select" id="close-heart-btn">
                <i class="fas fa-times"></i> Close Hearts
            </button>
        </div>
    </div>
    
    <div class="container">
        <header>
            <div class="header-content">
                <h1>Happy Birthday!</h1>
                <div class="subtitle">Wishing you a day as wonderful and special as you are</div>
                <div class="birthday-person" id="birthday-name">My Love</div>
                <div class="subtitle">May all your dreams and wishes come true today and always</div>
            </div>
        </header>
        
        <div class="card">
            <h2><i class="fas fa-birthday-cake"></i> Birthday Wishes</h2>
            <div class="wishes">
                <p>On your special day, I wish you endless joy, laughter, and all the happiness you deserve. May your life be filled with wonderful moments, cherished memories, and dreams that turn into reality.</p>
                <p>You are an amazing person who brings so much light into the lives of others. Today is your day to shine and be celebrated for the wonderful individual you are.</p>
                <p>May this new chapter of your life bring you closer to your goals, surround you with people who love and appreciate you, and fill your days with purpose and contentment.</p>
                <p>Remember that age is just a number, but the wisdom, experiences, and memories you've gathered are priceless treasures. Here's to making many more beautiful memories!</p>
            </div>
        </div>
        
        <!-- Love Button Section -->
        <div class="love-button-section">
            <h2><i class="fas fa-heart"></i> Special Gift For You</h2>
            <p>I've created a heart just for you, made of many smaller hearts. Each floating heart represents a piece of my love for you. Click the button below to see them come together!</p>
            <button class="love-btn no-select" id="love-btn">
                <i class="fas fa-heart"></i> Reveal My Heart
            </button>
        </div>
        
        <!-- Celebration Button -->
        <div class="celebration-section">
            <h2><i class="fas fa-party-horn"></i> Let's Celebrate!</h2>
            <p>Click the button below to launch a virtual celebration with confetti and animations. Let's make this birthday memorable!</p>
            <button class="celebration-btn no-select" id="celebration-btn">
                <i class="fas fa-birthday-cake"></i> Launch Celebration
            </button>
        </div>
        
        <div class="signature">
            <p id="signature-text">With all my love</p>
            <div class="from" id="from-text">From someone who loves you dearly</div>
        </div>
        
        <footer>
            <p>Made with <span class="heart-icon">‚ù§</span> for your special day | Wishing you a fantastic year ahead!</p>
            <p>¬© <span id="current-year">2023</span> Birthday Wishes with Love</p>
        </footer>
    </div>

    <script>
        // DOM Elements
        const loading = document.getElementById('loading');
        const birthdayName = document.getElementById('birthday-name');
        const loveBtn = document.getElementById('love-btn');
        const celebrationBtn = document.getElementById('celebration-btn');
        const heartContainer = document.getElementById('heart-container');
        const heartFormation = document.getElementById('heart-formation');
        const closeHeartBtn = document.getElementById('close-heart-btn');
        const heartTitle = document.getElementById('heart-title');
        const heartMessageText = document.getElementById('heart-message-text');
        const signatureText = document.getElementById('signature-text');
        const fromText = document.getElementById('from-text');
        const currentYear = document.getElementById('current-year');
        const backgroundHearts = document.getElementById('background-hearts');
        
        // Mobile detection
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
        
        // Performance optimization for mobile
        const heartConfig = {
            heartCount: isMobile ? 40 : 60,
            heartColors: ['#FF1493', '#FF6B8B', '#FF69B4', '#FFB6C1', '#DB7093']
        };
        
        // Background hearts configuration (reduced on mobile)
        const bgHeartConfig = {
            count: isMobile ? 15 : 25,
            minSize: 1,
            maxSize: isMobile ? 1.8 : 2.5,
            minDuration: 15,
            maxDuration: 25
        };
        
        // State management
        let isProcessing = false;
        let heartShapePoints = [];
        let bgHeartTimeouts = [];
        let activeTimeouts = [];
        
        // Love messages
        const loveMessages = [
            "Each floating heart represents a piece of my love for you.",
            "Together they form a complete heart, just like our love completes each other.",
            "Your smile makes my world brighter every day.",
            "You are the most beautiful person inside and out.",
            "My love for you grows stronger with each passing day.",
            "You make every moment special just by being you.",
            "I'm so grateful to have you in my life.",
            "Your happiness means everything to me.",
            "You deserve all the love in the world.",
            "My heart is forever yours."
        ];
        
        // Set current year
        currentYear.textContent = new Date().getFullYear();
        
        // Function to generate heart shape points
        function generateHeartShapePoints(count) {
            const points = [];
            for (let i = 0; i < count; i++) {
                const t = (i / count) * 2 * Math.PI;
                // Heart parametric equation
                const x = 16 * Math.pow(Math.sin(t), 3);
                const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
                
                // Scale based on device
                const scale = isMobile ? 10 : 12;
                const scaledX = x * scale;
                const scaledY = -y * scale; // Negative to flip heart right side up
                
                points.push({ x: scaledX, y: scaledY });
            }
            return points;
        }
        
        // Create background floating hearts (optimized for mobile)
        function createBackgroundHearts() {
            const fragment = document.createDocumentFragment();
            
            for (let i = 0; i < bgHeartConfig.count; i++) {
                const heart = document.createElement('div');
                heart.className = 'bg-heart will-change';
                heart.innerHTML = '‚ù§';
                
                // Random properties
                const size = Math.random() * (bgHeartConfig.maxSize - bgHeartConfig.minSize) + bgHeartConfig.minSize;
                const left = Math.random() * 100;
                const delay = Math.random() * 10;
                const duration = Math.random() * (bgHeartConfig.maxDuration - bgHeartConfig.minDuration) + bgHeartConfig.minDuration;
                const rotation = Math.random() * 360;
                
                // Apply styles
                heart.style.fontSize = `${size}rem`;
                heart.style.left = `${left}%`;
                heart.style.animationDelay = `${delay}s`;
                heart.style.animationDuration = `${duration}s`;
                heart.style.transform = `rotate(${rotation}deg)`;
                
                fragment.appendChild(heart);
                
                // Reset heart position after animation ends and restart
                const timeoutId = setTimeout(() => {
                    resetBackgroundHeart(heart);
                }, (delay + duration) * 1000);
                
                bgHeartTimeouts.push(timeoutId);
            }
            
            backgroundHearts.appendChild(fragment);
        }
        
        // Reset and restart background heart animation
        function resetBackgroundHeart(heart) {
            if (!heart.parentNode) return;
            
            const size = Math.random() * (bgHeartConfig.maxSize - bgHeartConfig.minSize) + bgHeartConfig.minSize;
            const left = Math.random() * 100;
            const delay = Math.random() * 5;
            const duration = Math.random() * (bgHeartConfig.maxDuration - bgHeartConfig.minDuration) + bgHeartConfig.minDuration;
            const rotation = Math.random() * 360;
            
            // Reset styles
            heart.style.fontSize = `${size}rem`;
            heart.style.left = `${left}%`;
            heart.style.animationDelay = `${delay}s`;
            heart.style.animationDuration = `${duration}s`;
            heart.style.transform = `rotate(${rotation}deg)`;
            
            // Reset animation
            heart.style.animation = 'none';
            setTimeout(() => {
                heart.style.animation = `floatBackground ${duration}s linear ${delay}s infinite`;
            }, 10);
            
            // Schedule next reset
            const timeoutId = setTimeout(() => {
                resetBackgroundHeart(heart);
            }, (delay + duration) * 1000);
            
            bgHeartTimeouts.push(timeoutId);
        }
        
        // Cleanup background hearts
        function cleanupBackgroundHearts() {
            bgHeartTimeouts.forEach(id => clearTimeout(id));
            bgHeartTimeouts = [];
        }
        
        // Function to set birthday details from URL parameters
        function setBirthdayDetailsFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Get name from URL or use default
            const name = urlParams.get('name') || 'My Love';
            birthdayName.textContent = name;
            
            // Get signature from URL or use default
            const signature = urlParams.get('signature') || 'With all my love';
            signatureText.textContent = signature;
            
            // Get from text from URL or use default
            const from = urlParams.get('from') || 'From someone who loves you dearly';
            fromText.textContent = from;
            
            // Customize heart message with name
            heartTitle.textContent = `For You, ${name}`;
            heartMessageText.textContent = `Each floating heart represents a piece of my love for you. Together they form a complete heart, just like our love completes each other. Happy Birthday, ${name}!`;
        }
        
        // Create floating hearts that form a heart shape together
        function createFloatingHeartFormation() {
            // Clear any existing hearts
            heartFormation.innerHTML = '';
            
            // Generate heart shape points if not already generated
            if (heartShapePoints.length === 0) {
                heartShapePoints = generateHeartShapePoints(heartConfig.heartCount);
            }
            
            // Get formation container dimensions
            const formationWidth = heartFormation.offsetWidth;
            const formationHeight = heartFormation.offsetHeight;
            
            // Create hearts for the formation
            heartShapePoints.forEach((point, index) => {
                const heart = document.createElement('div');
                heart.className = 'heart-float will-change';
                heart.innerHTML = '‚ù§';
                
                // Random color from heart colors
                const color = heartConfig.heartColors[Math.floor(Math.random() * heartConfig.heartColors.length)];
                
                // Set target position (center of formation)
                const targetX = point.x + 'px';
                const targetY = point.y + 'px';
                
                // Set CSS custom properties
                heart.style.setProperty('--target-x', targetX);
                heart.style.setProperty('--target-y', targetY);
                heart.style.color = color;
                heart.style.fontSize = `${Math.random() * 0.8 + (isMobile ? 1 : 1.2)}rem`;
                heart.style.left = '50%';
                heart.style.top = '50%';
                heart.style.transform = `translate(-50%, -50%) scale(0.1)`;
                heart.style.opacity = '0';
                
                heartFormation.appendChild(heart);
                
                // Force reflow to ensure transition works
                heart.offsetHeight;
                
                // Store timeout ID
                const timeout1 = setTimeout(() => {
                    heart.style.opacity = '1';
                    heart.classList.add('forming');
                    
                    const timeout2 = setTimeout(() => {
                        heart.classList.add('pulsing');
                    }, isMobile ? 800 : 1200 + index * 10);
                    
                    activeTimeouts.push(timeout2);
                    
                }, isMobile ? index * 30 : index * 40); // Staggered animation
                
                activeTimeouts.push(timeout1);
            });
            
            // Add some random floating hearts around the formation (fewer on mobile)
            createRandomFloatingHearts();
        }
        
        // Create random floating hearts around the formation
        function createRandomFloatingHearts() {
            const randomHeartCount = isMobile ? 15 : 25;
            const formationWidth = heartFormation.offsetWidth;
            const formationHeight = heartFormation.offsetHeight;
            
            for (let i = 0; i < randomHeartCount; i++) {
                const heart = document.createElement('div');
                heart.className = 'extra-heart';
                heart.innerHTML = '‚ù§';
                
                // Random properties
                const size = Math.random() * (isMobile ? 0.8 : 1.2) + 0.8;
                const color = heartConfig.heartColors[Math.floor(Math.random() * heartConfig.heartColors.length)];
                const startX = Math.random() * formationWidth + 'px';
                const startY = Math.random() * formationHeight + 'px';
                const endX = (Math.random() * 100 - 50) + 'px';
                const endY = (Math.random() * 100 - 50) + 'px';
                const rotation = Math.random() * 360;
                const delay = Math.random() * 1 + 0.5;
                const duration = Math.random() * (isMobile ? 4 : 6) + 3;
                
                // Set initial position (random around formation)
                heart.style.left = startX;
                heart.style.top = startY;
                heart.style.color = color;
                heart.style.fontSize = `${size}rem`;
                heart.style.transform = `translate(-50%, -50%) rotate(${rotation}deg) scale(0.1)`;
                heart.style.opacity = '0';
                
                heartFormation.appendChild(heart);
                
                // Animate after a delay
                const timeout1 = setTimeout(() => {
                    heart.style.transition = `transform ${duration}s ease-out, opacity ${duration/2}s ease`;
                    heart.style.transform = `translate(calc(-50% + ${endX}), calc(-50% + ${endY})) rotate(${rotation + 360}deg) scale(1)`;
                    heart.style.opacity = '0.6';
                    
                    // Remove after animation
                    const timeout2 = setTimeout(() => {
                        heart.style.opacity = '0';
                        const timeout3 = setTimeout(() => {
                            if (heart.parentNode) {
                                heart.remove();
                            }
                        }, 1000);
                        activeTimeouts.push(timeout3);
                    }, duration * 1000);
                    
                    activeTimeouts.push(timeout2);
                    
                }, delay * 1000);
                
                activeTimeouts.push(timeout1);
            }
        }
        
        // Show heart formation
        function showHeartFormation() {
            if (isProcessing) return;
            isProcessing = true;
            
            // Show the heart container first
            heartContainer.classList.add('active');
            
            // Prevent scrolling on body when heart is visible
            document.body.style.overflow = 'hidden';
            
            // Create the heart formation after a short delay to ensure container is visible
            const timeout = setTimeout(() => {
                createFloatingHeartFormation();
                isProcessing = false;
            }, 100);
            
            activeTimeouts.push(timeout);
            
            // Show random love message
            const randomMessage = loveMessages[Math.floor(Math.random() * loveMessages.length)];
            const name = birthdayName.textContent;
            heartMessageText.textContent = `${randomMessage} Happy Birthday, ${name}!`;
            
            // Vibrate device if supported (for mobile)
            vibrateDevice();
        }
        
        // Hide heart formation
        function hideHeartFormation() {
            if (isProcessing) return;
            isProcessing = true;
            
            heartContainer.classList.remove('active');
            
            // Re-enable scrolling
            document.body.style.overflow = 'auto';
            
            // Clear all active timeouts
            activeTimeouts.forEach(id => clearTimeout(id));
            activeTimeouts = [];
            
            // Remove all hearts with fade out
            const hearts = document.querySelectorAll('.heart-float, .extra-heart, .decorative-heart');
            hearts.forEach(heart => {
                heart.style.transition = 'opacity 0.3s ease';
                heart.style.opacity = '0';
                const timeout = setTimeout(() => {
                    if (heart.parentNode) {
                        heart.remove();
                    }
                }, 300);
                activeTimeouts.push(timeout);
            });
            
            // Clear heart shape points for next time
            heartShapePoints = [];
            
            setTimeout(() => {
                isProcessing = false;
            }, 500);
        }
        
        // Create confetti effect (optimized for mobile)
        function createConfetti() {
            if (isProcessing) return;
            isProcessing = true;
            
            const confettiCount = isMobile ? 100 : 200;
            const colors = ['#FF6B8B', '#6C63FF', '#FFD166', '#06D6A0', '#FF9E6D'];
            
            // Create confetti pieces
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti-piece';
                
                // Size based on device
                const size = isMobile ? Math.random() * 12 + 6 : Math.random() * 20 + 8;
                const shape = Math.random();
                
                confetti.style.cssText = `
                    position: fixed;
                    width: ${size}px;
                    height: ${size}px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    top: -30px;
                    left: ${Math.random() * 100}%;
                    border-radius: ${shape > 0.66 ? '50%' : shape > 0.33 ? '0' : '8px'};
                    z-index: 9999;
                    pointer-events: none;
                    opacity: 0.9;
                    transform-origin: center;
                `;
                
                document.body.appendChild(confetti);
                
                // Animate confetti
                const duration = Math.random() * (isMobile ? 3000 : 4000) + 2000;
                const endX = (Math.random() * 200 - 100) + 'px';
                
                confetti.animate([
                    { 
                        transform: 'translateY(0) rotate(0deg)', 
                        opacity: 1 
                    },
                    { 
                        transform: `translateY(${window.innerHeight + 100}px) translateX(${endX}) rotate(${Math.random() * 720}deg)`, 
                        opacity: 0 
                    }
                ], {
                    duration: duration,
                    easing: 'cubic-bezier(0.215, 0.61, 0.355, 1)'
                }).onfinish = () => {
                    if (confetti.parentNode) {
                        confetti.remove();
                    }
                };
            }
            
            // Show celebration message
            showCelebrationMessage();
            
            // Vibrate device if supported
            vibrateDevice();
            
            setTimeout(() => {
                isProcessing = false;
            }, 2000);
        }
        
        // Show celebration message
        function showCelebrationMessage() {
            const messages = [
                "üéâ Happy Birthday! üéâ",
                "üéÇ Celebrating You! üéÇ",
                "üéà Let's Party! üéà",
                "‚ú® You're Amazing! ‚ú®",
                "ü•≥ Cheers to You! ü•≥"
            ];
            
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            
            const toast = document.createElement('div');
            toast.textContent = randomMessage;
            toast.style.cssText = `
                position: fixed;
                top: 30px;
                left: 50%;
                transform: translateX(-50%) translateY(-100px);
                background: linear-gradient(135deg, #FF6B8B, #6C63FF);
                color: white;
                padding: ${isMobile ? '15px 25px' : '20px 40px'};
                border-radius: 50px;
                font-weight: bold;
                font-size: ${isMobile ? '1.3rem' : '1.5rem'};
                z-index: 10000;
                box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                animation: toastSlideIn 0.5s ease forwards;
                border: 2px solid white;
                text-align: center;
                max-width: 90%;
                word-wrap: break-word;
            `;
            
            document.body.appendChild(toast);
            
            // Remove toast after delay
            const timeout = setTimeout(() => {
                toast.style.animation = 'toastSlideOut 0.5s ease forwards';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.remove();
                    }
                }, 500);
            }, isMobile ? 3000 : 4000);
            
            activeTimeouts.push(timeout);
        }
        
        // Vibrate device if supported (for mobile)
        function vibrateDevice() {
            if (navigator.vibrate && isMobile) {
                // Short vibration pattern
                navigator.vibrate([50, 30, 50]);
            }
        }
        
        // Event handlers
        function handleLoveButton(e) {
            if (e.type === 'touchend') e.preventDefault();
            showHeartFormation();
        }
        
        function handleCelebration(e) {
            if (e.type === 'touchend') e.preventDefault();
            createConfetti();
        }
        
        function handleCloseHeart(e) {
            if (e.type === 'touchend') e.preventDefault();
            hideHeartFormation();
        }
        
        // Initialize touch and click events
        function initializeEvents() {
            loveBtn.addEventListener('click', handleLoveButton);
            loveBtn.addEventListener('touchend', handleLoveButton);
            
            celebrationBtn.addEventListener('click', handleCelebration);
            celebrationBtn.addEventListener('touchend', handleCelebration);
            
            closeHeartBtn.addEventListener('click', handleCloseHeart);
            closeHeartBtn.addEventListener('touchend', handleCloseHeart);
            
            // Close heart when clicking/touching outside the heart content
            heartContainer.addEventListener('click', function(e) {
                if (e.target === heartContainer) {
                    hideHeartFormation();
                }
            });
            
            heartContainer.addEventListener('touchend', function(e) {
                if (e.target === heartContainer) {
                    e.preventDefault();
                    hideHeartFormation();
                }
            });
        }
        
        // Cleanup function
        function cleanup() {
            cleanupBackgroundHearts();
            activeTimeouts.forEach(id => clearTimeout(id));
            activeTimeouts = [];
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set birthday details from URL parameters
            setBirthdayDetailsFromURL();
            
            // Create background hearts
            createBackgroundHearts();
            
            // Initialize events
            initializeEvents();
            
            // Hide loading screen after everything is ready
            setTimeout(() => {
                loading.classList.add('hidden');
                
                // Add toast animation styles
                if (!document.querySelector('style[data-toast-animations]')) {
                    const style = document.createElement('style');
                    style.setAttribute('data-toast-animations', 'true');
                    style.textContent = `
                        @keyframes toastSlideIn {
                            0% { transform: translateX(-50%) translateY(-100px); opacity: 0; }
                            100% { transform: translateX(-50%) translateY(0); opacity: 1; }
                        }
                        
                        @keyframes toastSlideOut {
                            0% { transform: translateX(-50%) translateY(0); opacity: 1; }
                            100% { transform: translateX(-50%) translateY(-100px); opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }, 1500);
            
            // Prevent unwanted scrolling when heart container is open
            document.addEventListener('touchmove', function(e) {
                if (heartContainer.classList.contains('active')) {
                    e.preventDefault();
                }
            }, { passive: false });
            
            // Fix for iOS bounce effect
            document.body.addEventListener('touchmove', function(e) {
                if (heartContainer.classList.contains('active')) {
                    e.preventDefault();
                }
            }, { passive: false });
        });
        
        // Add keyboard support (for accessibility)
        document.addEventListener('keydown', function(e) {
            // Escape key closes heart
            if (e.key === 'Escape' && heartContainer.classList.contains('active')) {
                hideHeartFormation();
            }
            
            // Space/Enter triggers buttons when focused
            if (e.code === 'Space' || e.code === 'Enter') {
                if (document.activeElement === loveBtn) {
                    showHeartFormation();
                } else if (document.activeElement === celebrationBtn) {
                    createConfetti();
                } else if (document.activeElement === closeHeartBtn) {
                    hideHeartFormation();
                }
            }
        });
        
        // Cleanup on page unload
        window.addEventListener('beforeunload', cleanup);
        window.addEventListener('pagehide', cleanup);
        
        // iOS specific fixes
        if (isIOS) {
            // Fix for iOS hover states
            document.addEventListener('touchstart', function() {}, {passive: true});
            
            // Prevent zoom on double tap
            document.addEventListener('dblclick', function(e) {
                e.preventDefault();
            }, { passive: false });
        }
    </script>
</body>
</html>
